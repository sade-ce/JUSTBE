@model RealEstate.Entities.ViewModels.UserProfileEditModel
@{
    ViewBag.Title = "Just BE | Edit Profile";
    ViewBag.ViewHeader = "Edit Your Profile";



    if (!string.IsNullOrEmpty(ViewBag.Message))
    {
        Layout = "~/Views/Shared/_LayoutCommon.cshtml";

    }
    else
    {
        <link href="https://justbere-d4d9.kxcdn.com/Content/bootstrap.min.css" rel="stylesheet" />

        Layout = "~/Areas/Client/Views/Shared/_ClientLayout.cshtml";


        <style>
            body {
                background-color: #F9F9F8;
                color: #323232;
                font-family: 'Raleway', 'Arial', sans-serif;
                height: 100%;
                overflow-x: hidden;
                width: 100%;
            }

            ol, ul, dl {
                margin-top: 28px !important;
                font-size: 0.9em;
            }

            .nav-item-parent > .nav-link, .kk:after {
                content: unset !important;
            }

            .dashboard-subheader-actions {
                background-color: #ffffff;
            }

            .fit-image {
                height: 100%;
                width: 100%;
                object-fit: contain;
                margin: auto;
                display: block;
            }

            .fit-image-div {
                height: 253px;
                width: 248px;
            }
        </style>

    }
}
<link href="/Content/SlimImageCropper/slim.css" rel="stylesheet" />

<style>
    #header {
        top: 0px !important;
    }
</style>

@if (!string.IsNullOrEmpty(ViewBag.Message))
{
    <div id="wrapper" class="wrapper-container">

        <!-- facebook link -->
        <!-- - - - - - - - - - - - - end Header - - - - - - - - - - - - - - - -->
        <!-- - - - - - - - - - - - - - Content - - - - - - - - - - - - - - - - -->

        <div id="content">



            <div class="page-section-3 page-section-bg">
                @if (ViewBag.message == "WelcomeBack")
                {
                    <div class="container">

                        <div class="align-center content-element3">

                            <h3>@{Html.RenderAction("UserDetails", "MyDeal", new { area = "Client" });}</h3>

                        </div>

                        <div class="icons-box">

                            <div class="row flex-row">

                                <div class="col-md-3 col-xs-6">

                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                    <div class="icons-wrap">

                                        <div class="icons-item">
                                            <div class="item-box">
                                                <h6 class="icons-box-title">Step 1</h6>
                                                <hr />
                                                <i class="licon-checkmark-circle"></i>
                                                <h6 class="icons-box-title"><a href="#">Password Secured</a></h6>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div class="col-md-3 col-xs-6">

                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                    <div class="icons-wrap">

                                        <div class="icons-item">
                                            <div class="item-box">
                                                <h6 class="icons-box-title">Step 2</h6>
                                                <hr />
                                                <i class="licon-profile"></i>
                                                <h6 class="icons-box-title"><a href="#">Set your profile picture</a></h6>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div class="col-md-3 col-xs-6">

                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                    <div class="icons-wrap">

                                        <div class="icons-item">
                                            <div class="item-box">
                                                <h6 class="icons-box-title">Step 3</h6>
                                                <hr />
                                                <i class="icon-email"></i>
                                                <h6 class="icons-box-title"><a href="#">Set your notification settings</a></h6>
                                            </div>
                                        </div>

                                    </div>

                                </div>
                                <div class="col-md-3 col-xs-6">

                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                    <div class="icons-wrap">

                                        <div class="icons-item">
                                            <div class="item-box">
                                                <h6 class="icons-box-title">Step 4</h6>
                                                <hr />

                                                <i class="licon-arrow-right"></i>
                                                <h6 class="icons-box-title"><a href="#">Go to your dashboard</a></h6>
                                            </div>
                                        </div>

                                    </div>

                                </div>


                            </div>

                        </div>

                    </div>
                                }

                                else
                                {
                                    <div class="container">

                                        <div class="align-center content-element3">

                                            <h3>Welcome to Just BE</h3>

                                        </div>

                                        <div class="icons-box">

                                            <div class="row flex-row">

                                                <div class="col-md-3 col-xs-6">

                                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                                    <div class="icons-wrap">

                                                        <div class="icons-item">
                                                            <div class="item-box">
                                                                <h6 class="icons-box-title">Step 1</h6>
                                                                <hr />
                                                                <i class="licon-checkmark-circle"></i>
                                                                <h6 class="icons-box-title"><a href="#">Sign-up complete</a></h6>
                                                            </div>
                                                        </div>

                                                    </div>

                                                </div>
                                                <div class="col-md-3 col-xs-6">

                                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                                    <div class="icons-wrap">

                                                        <div class="icons-item">
                                                            <div class="item-box">
                                                                <h6 class="icons-box-title">Step 2</h6>
                                                                <hr />
                                                                <i class="licon-profile"></i>
                                                                <h6 class="icons-box-title"><a href="#">Set your profile picture</a></h6>
                                                            </div>
                                                        </div>

                                                    </div>

                                                </div>
                                                <div class="col-md-3 col-xs-6">

                                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                                    <div class="icons-wrap">

                                                        <div class="icons-item">
                                                            <div class="item-box">
                                                                <h6 class="icons-box-title">Step 3</h6>
                                                                <hr />
                                                                <i class="icon-email"></i>
                                                                <h6 class="icons-box-title"><a href="#">Set your notification settings</a></h6>
                                                            </div>
                                                        </div>

                                                    </div>

                                                </div>
                                                <div class="col-md-3 col-xs-6">

                                                    <!-- - - - - - - - - - - - - - Icon Box Item - - - - - - - - - - - - - - - - -->
                                                    <div class="icons-wrap">

                                                        <div class="icons-item">
                                                            <div class="item-box">
                                                                <h6 class="icons-box-title">Step 4</h6>
                                                                <hr />

                                                                <i class="licon-arrow-right"></i>
                                                                <h6 class="icons-box-title"><a href="#">Go to your dashboard</a></h6>
                                                            </div>
                                                        </div>

                                                    </div>

                                                </div>

                                            </div>

                                        </div>

                                    </div>
                                }


            </div>

            <div class="page-section no-space">

                <div class="half-bg-col one-col-img">

                    <div class="container">

                        @using (Html.BeginForm("EditProfile", "Account", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
                        {
                            { TempData["message"] = ViewBag.message; }
                            @Html.HiddenFor(m => m.ProfileEdit.UserName)
                            @Html.HiddenFor(m => m.ProfileEdit.Name)
                            @Html.HiddenFor(m => m.ProfileEdit.LastName)
                            @Html.HiddenFor(m => m.ProfileEdit.Email)
                            @Html.HiddenFor(m => m.ProfileEdit.Phone)
                            <div class="row flex-row flex-center">
                                <div class="col-sm-6">

                                    <div class="half-bg-left push-top">

                                        <div class="img-col-left">
                                            <div class="custom-slider">
                                                <div class="team-item">

                                                    <div class="team-member">

                                                        <a href="#!" class="member-photo" style="border-radius:0px">
                                                            <div class="thumbnail">
                                                                <div id="imgPhotoThumb-wel">

                                                                    <div id="slim-cropper" class="slim img-rounded slim-sty" data-did-remove="imageWillBeRemoved"  data-size="248,253" style="max-width:248px;max-height:253px" data-label="Click or Drop your image here">
                                                                        <input type="file" name="upfiles" />
                                                                        @if (Model.ProfileEdit.UserPhotoThumb == null || Model.ProfileEdit.UserPhotoThumb == "")
                                                                        {
                                                                        }
                                                                        else
                                                                        { <img src="@Model.ProfileEdit.UserPhotoNormal" class="img-rounded" />
                                                                        }
                                                                        
                                                                        @Html.TextBoxFor(m => m.ProfileEdit.UserPhotoThumb,new { @class = "hidden" })
                                                                        @Html.TextBoxFor(m => m.ProfileEdit.UserPhotoNormal, new { @class = "hidden" })
                                                                    </div>
                                                                </div>
                                                            </div>
                                                          
                                                        </a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>

                                </div>



                                <div class="col-sm-6">

                                    <div class="img-content">
                                        <div class="member-info">
                                            <h6 class="member-position">We set the profile picture of yours we did like the most, you may update / change if you want </h6>

                                            <div class="photoUpload" style="width:240px">

                                                <ul class="tabs-nav clearfix">
                                                    <li style="margin-top: 10px;">
                                                        <a onclick="FB.login(setFacebookPhoto, { scope: 'user_photos' });" class="btn btn-big style-5">Upload Photo from Facebook</a>
                                                    </li>
                                                </ul>

                                            </div>




                                        </div>
                                    </div>

                                </div>

                            
                            </div>
                            <button class="btn btn-big style-5 pull-right">Next Step</button>
                        }

                    </div>

                </div>
            </div>

        </div>
    </div>
                                }

                                else
                                {


                                    <div class="main-wrapper">
                                        <div class="main">
                                            <div class="main-inner">

                                                <div class="content-title">
                                                    <div class="content-title-inner">
                                                        <div class="container">
                                                            <h1>Edit Profile</h1>

                                                        </div><!-- /.container -->
                                                    </div><!-- /.content-title-inner -->
                                                </div><!-- /.content-title -->

                                                <div class="content">
                                                    <div class="container">
                                                        <!-- /.filter -->

                                                        <div class="row">

                                                            <div class="col-md-offset-2 col-lg-9">

                                                                <div class="row">
                                                                    <div class="listing-detail col-md-12 col-lg-12">
                                                                        <div class="listing-contact-form">
                                                                            <div class="row">
                                                                                @using (Html.BeginForm("EditProfile", "Account", FormMethod.Post, new { @class = "form-horizontal", enctype = "multipart/form-data" }))
                                                                                {
                                                                                    { TempData["message"] = ViewBag.message; }


                                                                                    <div class="col-sm-7 col-sm-offset-1 my-profile">

                                                                                        @Html.HiddenFor(m => m.ProfileEdit.UserName)


                                                                                        <div class="form-group">
                                                                                            <label>First Name</label>
                                                                                            @Html.ValidationMessageFor(m => m.ProfileEdit.Name, "", new { @class = "text-danger" })
                                                                                            @Html.TextBoxFor(m => m.ProfileEdit.Name, new { @class = "form-control" })
                                                                                        </div>
                                                                                        <div class="form-group">
                                                                                            <label>Last Name</label>
                                                                                            @Html.ValidationMessageFor(m => m.ProfileEdit.LastName, "", new { @class = "text-danger" })
                                                                                            @Html.TextBoxFor(m => m.ProfileEdit.LastName, new { @class = "form-control" })
                                                                                        </div>

                                                                                        <div class="form-group">
                                                                                            <label>Email</label>
                                                                                            @Html.ValidationMessageFor(m => m.ProfileEdit.Email, "", new { @class = "text-danger" })
                                                                                            @Html.TextBoxFor(m => m.ProfileEdit.Email, new { @class = "form-control" })
                                                                                        </div>



                                                                                        <div class="form-group">
                                                                                            <label>Phone</label>
                                                                                            @Html.ValidationMessageFor(m => m.ProfileEdit.Phone, "", new { @class = "text-danger" })
                                                                                            @Html.TextBoxFor(m => m.ProfileEdit.Phone, new { @class = "form-control", @maxlength = "12" })
                                                                                        </div>
                                                                                    </div>

                                                                                    <div class="col-sm-4">
                                                                                        <!-- Avatar -->
                                                                                        <div class="edit-profile-photo">
                                                                                            <div class="thumbnail">
                                                                                                <div id="imgPhotoThumb">
                                                                                                    <div id="slim-cropper" class="slim img-rounded" data-size="248,253" style="max-width:248px;max-height:253px" data-did-remove="imageWillBeRemoved" data-label="Click or Drop your image here">
                                                                                                        <input type="file" name="upfiles" />
                                                                                                        @if (Model.ProfileEdit.UserPhotoThumb == null || Model.ProfileEdit.UserPhotoThumb == "")
                                                                                                        {
                                                                                                        }
                                                                                                        else
                                                                                                        { <img src="@Model.ProfileEdit.UserPhotoNormal" class="img-rounded" />
                                                                                                        }
                                                                                                    </div>
                                                                                                    @Html.TextBoxFor(m => m.ProfileEdit.UserPhotoThumb, new { @class = "hidden" })
                                                                                                    @Html.TextBoxFor(m => m.ProfileEdit.UserPhotoNormal, new { @class = "hidden" })
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="ortxt">
                                                                                                <p>or</p>
                                                                                            </div>
                                                                                            <div class="change-photo-btn">
                                                                                                <div class="photoUpload">
                                                                                                 
                                                                                                    <div class="dashboard-subheader-actions">
                                                                                                        <a class="btn btn-secondary" onclick="FB.login(setFacebookPhoto, { scope: 'user_photos' });" style="font-size: 13px;"><i class="fa fa-facebook"></i>Upload Photo from Facebook</a>
                                                                                                    </div>

                                                                                                </div>
                                                                                            </div>
                                                                                        </div>

                                                                                    </div>
                                                                                    @*</div>*@


                                                                                    <div class="col-sm-12">
                                                                                        <div class="form-group-btn btn-mob">
                                                                                            <button type="submit" class="btn btn-primary pull-left col-md-offset-3" style="background-color: #0bb7a5; border-color:#0bb7a5">Save Changes</button>
                                                                                        </div><!-- /.form-group-btn -->
                                                                                    </div>
                                                                                    @*</form>*@
                                                                                }
                                                                            </div><!-- /.row -->
                                                                        </div><!-- /.listing-contact-form -->

                                                                    </div>
                                                                </div>

                                                            </div>






                                                        </div>
                                                        <!-- /.row -->
                                                    </div><!-- /.container -->
                                                </div><!-- /.content -->
                                            </div><!-- /.main-inner -->
                                        </div><!-- /.main -->
                                    </div>



                                }






<div class="page-content-wrap"></div>


<link href="https://justbere-d4d9.kxcdn.com/Content/Plugins/cropper/cropper.min.css" rel="stylesheet" />



@*error message*@
<div id="ErrMsg" style="display:none;">
    <input type="hidden" id="ErrMsgHiddenField" name="ErrMsg" value="@TempData["ErrMsg"]" />
</div>



@section scripts {

    <script src="/Content/SlimImageCropper/slim.kickstart.js"></script>
    <script>

        function imageWillBeRemoved() {
            if ($("#slim-cropper").length) {
                $("#slim-cropper").find("input[type=hidden]").val('PhotoDeleted')
            }
        }
        //Init facebook functionality by using FB.init() with parameters
        window.fbAsyncInit = function () {
            FB.init({
                appId: 1706912639383149,//866791937005855, // App ID for JBG 400646813722499 //App ID for Site.capitalhill: 1706912639383149
                channelUrl: '//' + document.domain + '/fbchannel.html', // Channel File
                status: true, // check login status
                cookie: true, // enable cookies to allow the server to access the session
                xfbml: true  // parse XFBML
            });
        };

        // Self-invoking anonymous function that loads facebook SDK
        (function (d) {
            var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
            if (d.getElementById(id)) { return; }
            js = d.createElement('script'); js.id = id; js.async = true;
            js.src = "//connect.facebook.net/en_US/all.js";
            ref.parentNode.insertBefore(js, ref);
        })(document);

        function setFacebookPhoto(response) {

            if (response.status === 'connected') {
                FB.api('/me/?fields=picture.width(248).height(253)', function (response) {
                    $('#slim-cropper').css('display', 'none')
                    if ($("#divFacebook").length) {
                        $("#divFacebook").remove();
                    }
                    if ($("#imgPhotoThumb-wel").length) { $("#imgPhotoThumb-wel").after('<div id="divFacebook" class="img-rounded slim-sty"> </div>') }
                    else { $("#imgPhotoThumb").after('<div id="divFacebook" class="img-rounded"> </div>') }
                    
                    var cropper = new Slim(document.getElementById('divFacebook'), {
                        label: 'Click or Drop your image here',
                        forceSize: {
                            width: 248,
                            height: 253,
                        },
                        didRemove: function() {
                            $("#divFacebook").find("input[type=hidden]").val('PhotoDeleted')
                        }
                      
                    });
                    cropper.load(response.picture.data.url);
                    $("#divFacebook").find("input[type=hidden]").attr('name', 'upfiles')


                });
            }
        }
    </script>

    <script>
        $('#ProfileEdit_Phone')

          .keydown(function (e) {
              var key = e.which || e.charCode || e.keyCode || 0;
              $phone = $(this);

              // Don't let them remove the starting '('


              // Auto-format- do not expose the mask as the user begins to type
              if (key !== 8 && key !== 9) {
                  if ($phone.val().length === 3) {
                      $phone.val($phone.val() + '.');
                  }
                  if ($phone.val().length === 7) {
                      $phone.val($phone.val() + '.');
                  }

              }

              // Allow numeric (and tab, backspace, delete) keys only
              return (key == 8 ||
                      key == 9 ||
                      key == 46 ||
                      (key >= 48 && key <= 57) ||
                      (key >= 96 && key <= 105));
          })

          .bind('focus click', function () {
              $phone = $(this);

          })

          .blur(function () {
              $phone = $(this);


          });
    </script>

}
<style>
    .thumbnail {
        background-color: #fff;
        border: #fff;
    }

    label {
        display: block;
        font-weight: bold;
        font-size: 16px;
        font-weight: normal;
        margin-bottom: 8px;
        text-transform: initial;
    }

    body {
        font-size: 15px;
        line-height: 27px;
    }

    .change-photo-btn {
        left: 4px;
        bottom: unset;
        background-color: #f8f9f9;
    }

        .change-photo-btn:hover {
            color: none;
        }

    @@media screen and (min-width: 320px) and (max-width: 425px) {
        .btn-mob {
            margin-top: 30px;
            margin-left: 44px;
        }
    }

    @@media screen and (min-width: 426px) and (max-width: 542px) {
        .btn-mob {
            margin-top: 30px;
            margin-left: 44px;
        }
    }

    .slim .slim-file-hopper {
        /*background-image: url(https://justbere-d4d9.kxcdn.com/img/NoImage.png);*/
    }

    .slim-sty {
        background-color: #b1b3b6 !important;
        font-size: 18px !important;
        color: #ffffff !important;
        font-weight: 400 !important;
    }

    .ortxt p {
    background: #fff;
    text-align: center;
    width: 38px;
    margin: 0 auto;
    border-radius: 50px;
    line-height: 30px;
    margin-bottom: 20px;
    position: relative;
}
.ortxt:before {
    position: absolute;
    height: 1px;
    content: "";
    background: rgba(0,0,0,.2);
    / z-index: 1; /
    width: 100%;
    left: 0;
    right: 0;
    top: 13px;
}

.ortxt {
    position: relative;
}
</style>